import { isAddress } from "ethers/lib/utils";
import React, { useState } from "react";
import "../../styles/Vulnerability/ContactInfo.scss";
import { AccordionContext } from "./VulnerabilityAccordion";
import classNames from "classnames";
import { Card, IContactData } from "./types";
import { useTranslation } from "react-i18next";

interface IProps {
  data: IContactData
}

export default function ContactInfo({ data }: IProps) {
  const { t } = useTranslation();
  const [username, setUsername] = useState(data.username);
  const [beneficiary, setBeneficiary] = useState(data.beneficiary);

  const { submitCard } = React.useContext(AccordionContext);

  const usernameInputClass = classNames({
    "input-error": username === ""
  })

  const beneficiaryInputClass = classNames({
    "input-error": !isAddress(beneficiary)
  })

  return (
    <div className="contact-info-wrapper card-content">
      <div>{t("ContactInfo.telegram-user")}</div>
      <input className={usernameInputClass} autoFocus type="text" placeholder={t("ContactInfo.telegram-user-placeholder")} value={username} onChange={(e) => setUsername(e.target.value)} />
      <div>{t("ContactInfo.beneficiary")}</div>
      <input className={beneficiaryInputClass} type="text" placeholder={t("ContactInfo.beneficiary-placeholder")} value={beneficiary} onChange={(e) => setBeneficiary(e.target.value)} />
      {beneficiary !== "" && !isAddress(beneficiary) && <span className="error">{t("ContactInfo.invalid-address")}</span>}
      <div className="add-contact-data">
        <button disabled={username === "" || beneficiary === "" || !isAddress(beneficiary)} onClick={() => submitCard(Card.contact, Card.description, { username: username, beneficiary: beneficiary })}>{t("ContactInfo.add")}</button>
      </div>
    </div>
  )
}
